<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistical Modeling with a Single Mediator • CMAverse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Statistical Modeling with a Single Mediator">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CMAverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../articles/overview.html">Overview of Modeling Approaches</a>
</li>
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/single_mediator.html">Statistical Modeling with a Single Mediator</a>
    </li>
    <li>
      <a href="../articles/case_control.html">Statistical Modeling for a Case Control Study</a>
    </li>
    <li>
      <a href="../articles/multiple_imputation.html">Statistical Modeling with Missing Data</a>
    </li>
    <li>
      <a href="../articles/post_exposure_confounding.html">Statistical Modeling with Post-exposure Confounding</a>
    </li>
    <li>
      <a href="../articles/measurement_error.html">Sensitivity Analysis for Measurement Error</a>
    </li>
    <li>
      <a href="../articles/time_to_event_mediator.html">Statistical Modeling with Time-to-event Mediators and Competing Risks</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>

    Functions
  </a>
</li>
<li>
  <a href="https://github.com/XiaoniXu/CMAverse/" class="external-link">
    <span class="fa fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Statistical Modeling with a Single Mediator</h1>
            
            <h4 data-toc-skip class="date">2025-12-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/XiaoniXu/CMAverse/blob/HEAD/vignettes/single_mediator.Rmd" class="external-link"><code>vignettes/single_mediator.Rmd</code></a></small>
      <div class="hidden name"><code>single_mediator.Rmd</code></div>

    </div>

    
    
<p>This example demonstrates how to use <code>cmest</code> when there is
a single mediator. For this purpose, we simulate some data containing a
continuous baseline confounder
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
a binary baseline confounder
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
a binary exposure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
a binary mediator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
and a binary outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.
The true regression models for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
are:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>C</mi><mn>1</mn></msub><mo>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.2</mn><mo>+</mo><mn>0.5</mn><msub><mi>C</mi><mn>1</mn></msub><mo>+</mo><mn>0.1</mn><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">logit(E(A|C_1,C_2))=0.2+0.5C_1+0.1C_2</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo stretchy="false" form="prefix">|</mo><mi>A</mi><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>A</mi><mo>+</mo><mn>1.5</mn><msub><mi>C</mi><mn>1</mn></msub><mo>+</mo><mn>0.8</mn><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">logit(E(M|A,C_1,C_2))=1+2A+1.5C_1+0.8C_2</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mi>A</mi><mo>,</mo><mi>M</mi><mo>,</mo><msub><mi>C</mi><mn>1</mn></msub><mo>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>−</mi><mn>3</mn><mo>−</mo><mn>0.4</mn><mi>A</mi><mo>−</mo><mn>1.2</mn><mi>M</mi><mo>+</mo><mn>0.5</mn><mi>A</mi><mi>M</mi><mo>+</mo><mn>0.3</mn><msub><mi>C</mi><mn>1</mn></msub><mo>−</mo><mn>0.6</mn><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">logit(E(Y|A,M,C_1,C_2)))=-3-0.4A-1.2M+0.5AM+0.3C_1-0.6C_2</annotation></semantics></math></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xiaonixu.github.io/CMAverse/">CMAverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">expit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">C1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">C2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu">expit</span><span class="op">(</span><span class="fl">0.2</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">C1</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu">expit</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">A</span> <span class="op">+</span> <span class="fl">1.5</span><span class="op">*</span><span class="va">C1</span> <span class="op">+</span> <span class="fl">0.8</span><span class="op">*</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu">expit</span><span class="op">(</span><span class="op">-</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">0.4</span><span class="op">*</span><span class="va">A</span> <span class="op">-</span> <span class="fl">1.2</span><span class="op">*</span><span class="va">M</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">A</span><span class="op">*</span><span class="va">M</span> <span class="op">+</span> <span class="fl">0.3</span><span class="op">*</span><span class="va">C1</span> <span class="op">-</span> <span class="fl">0.6</span><span class="op">*</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">M</span>, <span class="va">Y</span>, <span class="va">C1</span>, <span class="va">C2</span><span class="op">)</span></span></code></pre></div>
<p>The DAG for this scientific setting is:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cmdag.html">cmdag</a></span><span class="op">(</span>outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>, mediator <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>      basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, postc <span class="op">=</span> <span class="cn">NULL</span>, node <span class="op">=</span> <span class="cn">TRUE</span>, text_col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p><img src="single_mediator_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" width="700"></p>
<p>In this setting, we can use all of the six statistical modeling
approaches. The results are shown below:</p>
<div class="section level3">
<h3 id="the-regression-based-approach">The Regression-based Approach<a class="anchor" aria-label="anchor" href="#the-regression-based-approach"></a>
</h3>
<div class="section level4">
<h4 id="closed-form-parameter-function-estimation-and-delta-method-inference">Closed-form Parameter Function Estimation and Delta Method
Inference<a class="anchor" aria-label="anchor" href="#closed-form-parameter-function-estimation-and-delta-method-inference"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_rb_param_delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"rb"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                            mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            mreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                            astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                            estimation <span class="op">=</span> <span class="st">"paramfunc"</span>, inference <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_rb_param_delta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Causal Mediation Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Outcome regression:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Y ~ A + M + A * M + C1 + C2, family = binomial(), </span></span>
<span><span class="co">##     data = getCall(x$reg.output$yreg)$data, weights = getCall(x$reg.output$yreg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.5731     0.7713  -4.633 3.61e-06 ***</span></span>
<span><span class="co">## A             0.7084     0.5283   1.341  0.17990    </span></span>
<span><span class="co">## M            -1.0471     0.3736  -2.803  0.00507 ** </span></span>
<span><span class="co">## C1            0.9337     0.6973   1.339  0.18054    </span></span>
<span><span class="co">## C2           -0.8415     0.1443  -5.829 5.56e-09 ***</span></span>
<span><span class="co">## A:M          -0.4222     0.5541  -0.762  0.44607    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2022.7  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1965.0  on 9994  degrees of freedom</span></span>
<span><span class="co">## AIC: 1977</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Mediator regressions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = M ~ A + C1 + C2, family = binomial(), data = getCall(x$reg.output$mreg[[1L]])$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$mreg[[1L]])$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)   0.4353     0.6410   0.679  0.49712    </span></span>
<span><span class="co">## A             1.7076     0.1443  11.837  &lt; 2e-16 ***</span></span>
<span><span class="co">## C1            1.9982     0.6474   3.086  0.00203 ** </span></span>
<span><span class="co">## C2            0.9024     0.1345   6.709 1.96e-11 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2294.0  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 2072.5  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 2080.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Effect decomposition on the odds ratio scale via the regression-based approach</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Closed-form parameter function estimation with </span></span>
<span><span class="co">##  delta method standard errors, confidence intervals and p-values </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##                Estimate Std.error  95% CIL 95% CIU    P.val    </span></span>
<span><span class="co">## Rcde            1.33138   0.22278  0.95912   1.848   0.0872 .  </span></span>
<span><span class="co">## Rpnde           1.41988   0.23708  1.02358   1.970   0.0358 *  </span></span>
<span><span class="co">## Rtnde           1.34928   0.22056  0.97940   1.859   0.0669 .  </span></span>
<span><span class="co">## Rpnie           0.93338   0.03576  0.86587   1.006   0.0719 .  </span></span>
<span><span class="co">## Rtnie           0.88697   0.05295  0.78902   0.997   0.0445 *  </span></span>
<span><span class="co">## Rte             1.25939   0.19804  0.92535   1.714   0.1425    </span></span>
<span><span class="co">## ERcde           0.30416   0.20019 -0.08820   0.697   0.1287    </span></span>
<span><span class="co">## ERintref        0.11571   0.11472 -0.10914   0.341   0.3131    </span></span>
<span><span class="co">## ERintmed       -0.09387   0.09323 -0.27659   0.089   0.3140    </span></span>
<span><span class="co">## ERpnie         -0.06662   0.03576 -0.13670   0.003   0.0624 .  </span></span>
<span><span class="co">## ERcde(prop)     1.17262   0.23540  0.71124   1.634 6.32e-07 ***</span></span>
<span><span class="co">## ERintref(prop)  0.44610   0.49051 -0.51528   1.407   0.3631    </span></span>
<span><span class="co">## ERintmed(prop) -0.36189   0.39881 -1.14354   0.420   0.3642    </span></span>
<span><span class="co">## ERpnie(prop)   -0.25684   0.23474 -0.71691   0.203   0.2739    </span></span>
<span><span class="co">## pm             -0.61872   0.50289 -1.60437   0.367   0.2186    </span></span>
<span><span class="co">## int             0.08421   0.09264 -0.09736   0.266   0.3633    </span></span>
<span><span class="co">## pe             -0.17262   0.23540 -0.63400   0.289   0.4634    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Rcde: controlled direct effect odds ratio; Rpnde: pure natural direct effect odds ratio; Rtnde: total natural direct effect odds ratio; Rpnie: pure natural indirect effect odds ratio; Rtnie: total natural indirect effect odds ratio; Rte: total effect odds ratio; ERcde: excess relative risk due to controlled direct effect; ERintref: excess relative risk due to reference interaction; ERintmed: excess relative risk due to mediated interaction; ERpnie: excess relative risk due to pure natural indirect effect; ERcde(prop): proportion ERcde; ERintref(prop): proportion ERintref; ERintmed(prop): proportion ERintmed; ERpnie(prop): proportion ERpnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Relevant variable values: </span></span>
<span><span class="co">## $a</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $astar</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $yval</span></span>
<span><span class="co">## [1] "1"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mval</span></span>
<span><span class="co">## $mval[[1]]</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $basecval</span></span>
<span><span class="co">## $basecval[[1]]</span></span>
<span><span class="co">## [1] 0.9993463</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $basecval[[2]]</span></span>
<span><span class="co">## [1] 0.6061</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="closed-form-parameter-function-estimation-and-bootstrap-inference">Closed-form Parameter Function Estimation and Bootstrap
Inference<a class="anchor" aria-label="anchor" href="#closed-form-parameter-function-estimation-and-bootstrap-inference"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_rb_param_bootstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"rb"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                mreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                                astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                                estimation <span class="op">=</span> <span class="st">"paramfunc"</span>, inference <span class="op">=</span> <span class="st">"bootstrap"</span>, nboot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_rb_param_bootstrap</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Causal Mediation Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Outcome regression:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Y ~ A + M + A * M + C1 + C2, family = binomial(), </span></span>
<span><span class="co">##     data = getCall(x$reg.output$yreg)$data, weights = getCall(x$reg.output$yreg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.5731     0.7713  -4.633 3.61e-06 ***</span></span>
<span><span class="co">## A             0.7084     0.5283   1.341  0.17990    </span></span>
<span><span class="co">## M            -1.0471     0.3736  -2.803  0.00507 ** </span></span>
<span><span class="co">## C1            0.9337     0.6973   1.339  0.18054    </span></span>
<span><span class="co">## C2           -0.8415     0.1443  -5.829 5.56e-09 ***</span></span>
<span><span class="co">## A:M          -0.4222     0.5541  -0.762  0.44607    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2022.7  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1965.0  on 9994  degrees of freedom</span></span>
<span><span class="co">## AIC: 1977</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Mediator regressions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = M ~ A + C1 + C2, family = binomial(), data = getCall(x$reg.output$mreg[[1L]])$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$mreg[[1L]])$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)   0.4353     0.6410   0.679  0.49712    </span></span>
<span><span class="co">## A             1.7076     0.1443  11.837  &lt; 2e-16 ***</span></span>
<span><span class="co">## C1            1.9982     0.6474   3.086  0.00203 ** </span></span>
<span><span class="co">## C2            0.9024     0.1345   6.709 1.96e-11 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2294.0  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 2072.5  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 2080.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Effect decomposition on the odds ratio scale via the regression-based approach</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Closed-form parameter function estimation with </span></span>
<span><span class="co">##  bootstrap standard errors, percentile confidence intervals and p-values </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##                Estimate Std.error  95% CIL 95% CIU  P.val    </span></span>
<span><span class="co">## Rcde            1.33138   0.06172  1.14345   1.226 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnde           1.41987   0.19318  1.22863   1.488 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnde           1.34928   0.08947  1.16265   1.283 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnie           0.93338   0.00654  0.90612   0.915 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnie           0.88697   0.05118  0.78870   0.857 &lt;2e-16 ***</span></span>
<span><span class="co">## Rte             1.25939   0.08946  1.05350   1.174 &lt;2e-16 ***</span></span>
<span><span class="co">## ERcde           0.30416   0.05645  0.12662   0.202 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintref        0.11571   0.13672  0.10265   0.286 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintmed       -0.09387   0.11025 -0.22985  -0.082 &lt;2e-16 ***</span></span>
<span><span class="co">## ERpnie         -0.06662   0.00654 -0.09388  -0.085 &lt;2e-16 ***</span></span>
<span><span class="co">## ERcde(prop)     1.17262   0.92815  1.18783   2.435 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintref(prop)  0.44610   0.20645  1.65213   1.929 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintmed(prop) -0.36189   0.15593 -1.53545  -1.326 &lt;2e-16 ***</span></span>
<span><span class="co">## ERpnie(prop)   -0.25684   0.97867 -1.82886  -0.514 &lt;2e-16 ***</span></span>
<span><span class="co">## pm             -0.61872   1.13460 -3.36430  -1.840 &lt;2e-16 ***</span></span>
<span><span class="co">## int             0.08421   0.05052  0.32617   0.394 &lt;2e-16 ***</span></span>
<span><span class="co">## pe             -0.17262   0.92815 -1.43481  -0.188 &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Rcde: controlled direct effect odds ratio; Rpnde: pure natural direct effect odds ratio; Rtnde: total natural direct effect odds ratio; Rpnie: pure natural indirect effect odds ratio; Rtnie: total natural indirect effect odds ratio; Rte: total effect odds ratio; ERcde: excess relative risk due to controlled direct effect; ERintref: excess relative risk due to reference interaction; ERintmed: excess relative risk due to mediated interaction; ERpnie: excess relative risk due to pure natural indirect effect; ERcde(prop): proportion ERcde; ERintref(prop): proportion ERintref; ERintmed(prop): proportion ERintmed; ERpnie(prop): proportion ERpnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Relevant variable values: </span></span>
<span><span class="co">## $a</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $astar</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $yval</span></span>
<span><span class="co">## [1] "1"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mval</span></span>
<span><span class="co">## $mval[[1]]</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $basecval</span></span>
<span><span class="co">## $basecval[[1]]</span></span>
<span><span class="co">## [1] 0.9993463</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $basecval[[2]]</span></span>
<span><span class="co">## [1] 0.6061</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="direct-counterfactual-imputation-estimation-and-bootstrap-inference">Direct Counterfactual Imputation Estimation and Bootstrap
Inference<a class="anchor" aria-label="anchor" href="#direct-counterfactual-imputation-estimation-and-bootstrap-inference"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_rb_impu_bootstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"rb"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                               mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                               mreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                               astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                               estimation <span class="op">=</span> <span class="st">"imputation"</span>, inference <span class="op">=</span> <span class="st">"bootstrap"</span>, nboot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_rb_impu_bootstrap</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Causal Mediation Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Outcome regression:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Y ~ A + M + A * M + C1 + C2, family = binomial(), </span></span>
<span><span class="co">##     data = getCall(x$reg.output$yreg)$data, weights = getCall(x$reg.output$yreg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.5731     0.7713  -4.633 3.61e-06 ***</span></span>
<span><span class="co">## A             0.7084     0.5283   1.341  0.17990    </span></span>
<span><span class="co">## M            -1.0471     0.3736  -2.803  0.00507 ** </span></span>
<span><span class="co">## C1            0.9337     0.6973   1.339  0.18054    </span></span>
<span><span class="co">## C2           -0.8415     0.1443  -5.829 5.56e-09 ***</span></span>
<span><span class="co">## A:M          -0.4222     0.5541  -0.762  0.44607    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2022.7  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1965.0  on 9994  degrees of freedom</span></span>
<span><span class="co">## AIC: 1977</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Mediator regressions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = M ~ A + C1 + C2, family = binomial(), data = getCall(x$reg.output$mreg[[1L]])$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$mreg[[1L]])$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)   0.4353     0.6410   0.679  0.49712    </span></span>
<span><span class="co">## A             1.7076     0.1443  11.837  &lt; 2e-16 ***</span></span>
<span><span class="co">## C1            1.9982     0.6474   3.086  0.00203 ** </span></span>
<span><span class="co">## C2            0.9024     0.1345   6.709 1.96e-11 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2294.0  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 2072.5  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 2080.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Effect decomposition on the odds ratio scale via the regression-based approach</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Direct counterfactual imputation estimation with </span></span>
<span><span class="co">##  bootstrap standard errors, percentile confidence intervals and p-values </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##                 Estimate Std.error   95% CIL 95% CIU  P.val    </span></span>
<span><span class="co">## Rcde            1.330044  0.009511  1.257553   1.270 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnde           1.420177  0.137613  1.364635   1.550 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnde           1.349577  0.011604  1.288417   1.304 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnie           0.924473  0.003410  0.912807   0.917 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnie           0.878515  0.072922  0.768186   0.866 &lt;2e-16 ***</span></span>
<span><span class="co">## Rte             1.247647  0.006199  1.181979   1.190 &lt;2e-16 ***</span></span>
<span><span class="co">## ERcde           0.292988  0.008426  0.226739   0.238 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintref        0.127190  0.146039  0.126886   0.323 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintmed       -0.097003  0.128004 -0.272328  -0.100 &lt;2e-16 ***</span></span>
<span><span class="co">## ERpnie         -0.075527  0.003410 -0.087192  -0.083 &lt;2e-16 ***</span></span>
<span><span class="co">## ERcde(prop)     1.183086  0.086892  1.191564   1.308 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintref(prop)  0.513593  0.744711  0.696016   1.697 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintmed(prop) -0.391700  0.654687 -1.429943  -0.550 &lt;2e-16 ***</span></span>
<span><span class="co">## ERpnie(prop)   -0.304980  0.003131 -0.458158  -0.454 &lt;2e-16 ***</span></span>
<span><span class="co">## pm             -0.696679  0.657819 -1.888101  -1.004 &lt;2e-16 ***</span></span>
<span><span class="co">## int             0.121894  0.090024  0.145647   0.267 &lt;2e-16 ***</span></span>
<span><span class="co">## pe             -0.183086  0.086892 -0.308304  -0.192 &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Rcde: controlled direct effect odds ratio; Rpnde: pure natural direct effect odds ratio; Rtnde: total natural direct effect odds ratio; Rpnie: pure natural indirect effect odds ratio; Rtnie: total natural indirect effect odds ratio; Rte: total effect odds ratio; ERcde: excess relative risk due to controlled direct effect; ERintref: excess relative risk due to reference interaction; ERintmed: excess relative risk due to mediated interaction; ERpnie: excess relative risk due to pure natural indirect effect; ERcde(prop): proportion ERcde; ERintref(prop): proportion ERintref; ERintmed(prop): proportion ERintmed; ERpnie(prop): proportion ERpnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Relevant variable values: </span></span>
<span><span class="co">## $a</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $astar</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $yval</span></span>
<span><span class="co">## [1] "1"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mval</span></span>
<span><span class="co">## $mval[[1]]</span></span>
<span><span class="co">## [1] 1</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="the-weighting-based-approach">The Weighting-based Approach<a class="anchor" aria-label="anchor" href="#the-weighting-based-approach"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"wb"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                ereg <span class="op">=</span> <span class="st">"logistic"</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                estimation <span class="op">=</span> <span class="st">"imputation"</span>, inference <span class="op">=</span> <span class="st">"bootstrap"</span>, nboot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_wb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Causal Mediation Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Outcome regression:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Y ~ A + M + A * M + C1 + C2, family = binomial(), </span></span>
<span><span class="co">##     data = getCall(x$reg.output$yreg)$data, weights = getCall(x$reg.output$yreg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.5731     0.7713  -4.633 3.61e-06 ***</span></span>
<span><span class="co">## A             0.7084     0.5283   1.341  0.17990    </span></span>
<span><span class="co">## M            -1.0471     0.3736  -2.803  0.00507 ** </span></span>
<span><span class="co">## C1            0.9337     0.6973   1.339  0.18054    </span></span>
<span><span class="co">## C2           -0.8415     0.1443  -5.829 5.56e-09 ***</span></span>
<span><span class="co">## A:M          -0.4222     0.5541  -0.762  0.44607    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2022.7  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1965.0  on 9994  degrees of freedom</span></span>
<span><span class="co">## AIC: 1977</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Exposure regression for weighting: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = A ~ C1 + C2, family = binomial(), data = getCall(x$reg.output$ereg)$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$ereg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span><span class="co">## (Intercept)  0.08342    0.21440   0.389  0.69723   </span></span>
<span><span class="co">## C1           0.60899    0.21208   2.872  0.00409 **</span></span>
<span><span class="co">## C2           0.10532    0.04375   2.407  0.01606 * </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 12534  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 12520  on 9997  degrees of freedom</span></span>
<span><span class="co">## AIC: 12526</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Effect decomposition on the odds ratio scale via the weighting-based approach</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Direct counterfactual imputation estimation with </span></span>
<span><span class="co">##  bootstrap standard errors, percentile confidence intervals and p-values </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##                 Estimate Std.error   95% CIL 95% CIU  P.val    </span></span>
<span><span class="co">## Rcde             1.33004   0.19217   0.96491   1.223      1    </span></span>
<span><span class="co">## Rpnde            1.42603   0.12670   1.16844   1.339 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnde            1.35033   0.18078   1.00664   1.249 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnie            0.92151   0.03436   0.93377   0.980 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnie            0.87259   0.02034   0.84425   0.872 &lt;2e-16 ***</span></span>
<span><span class="co">## Rte              1.24434   0.13420   0.98645   1.167      1    </span></span>
<span><span class="co">## ERcde            0.29184   0.17394  -0.03315   0.201      1    </span></span>
<span><span class="co">## ERintref         0.13419   0.04724   0.13843   0.202 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintmed        -0.10320   0.04186  -0.16187  -0.106 &lt;2e-16 ***</span></span>
<span><span class="co">## ERpnie          -0.07849   0.03436  -0.06620  -0.020 &lt;2e-16 ***</span></span>
<span><span class="co">## ERcde(prop)      1.19441   0.70245   1.22728   2.171 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintref(prop)   0.54919   8.60458 -11.06885   0.491      1    </span></span>
<span><span class="co">## ERintmed(prop)  -0.42236   6.88147  -0.36260   8.883      1    </span></span>
<span><span class="co">## ERpnie(prop)    -0.32123   1.02066  -0.35611   1.015      1    </span></span>
<span><span class="co">## pm              -0.74359   7.90213  -0.71871   9.898      1    </span></span>
<span><span class="co">## int              0.12682   1.72311  -2.18618   0.129      1    </span></span>
<span><span class="co">## pe              -0.19441   0.70245  -1.17102  -0.227 &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Rcde: controlled direct effect odds ratio; Rpnde: pure natural direct effect odds ratio; Rtnde: total natural direct effect odds ratio; Rpnie: pure natural indirect effect odds ratio; Rtnie: total natural indirect effect odds ratio; Rte: total effect odds ratio; ERcde: excess relative risk due to controlled direct effect; ERintref: excess relative risk due to reference interaction; ERintmed: excess relative risk due to mediated interaction; ERpnie: excess relative risk due to pure natural indirect effect; ERcde(prop): proportion ERcde; ERintref(prop): proportion ERintref; ERintmed(prop): proportion ERintmed; ERpnie(prop): proportion ERpnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Relevant variable values: </span></span>
<span><span class="co">## $a</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $astar</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $yval</span></span>
<span><span class="co">## [1] "1"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mval</span></span>
<span><span class="co">## $mval[[1]]</span></span>
<span><span class="co">## [1] 1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-inverse-odds-ratio-weighting-approach">The Inverse Odds-ratio Weighting Approach<a class="anchor" aria-label="anchor" href="#the-inverse-odds-ratio-weighting-approach"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_iorw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"iorw"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                  mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, </span>
<span>                  ereg <span class="op">=</span> <span class="st">"logistic"</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                  astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                  estimation <span class="op">=</span> <span class="st">"imputation"</span>, inference <span class="op">=</span> <span class="st">"bootstrap"</span>, nboot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_iorw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Causal Mediation Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Outcome regression for the total effect: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Y ~ A + C1 + C2, family = binomial(), data = getCall(x$reg.output$yregTot)$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$yregTot)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -4.4182     0.7137  -6.191 5.98e-10 ***</span></span>
<span><span class="co">## A             0.2183     0.1565   1.395    0.163    </span></span>
<span><span class="co">## C1            0.8540     0.6956   1.228    0.220    </span></span>
<span><span class="co">## C2           -0.8831     0.1435  -6.156 7.47e-10 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2022.7  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1980.4  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 1988.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Outcome regression for the direct effect: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Y ~ A + C1 + C2, family = binomial(), data = getCall(x$reg.output$yregDir)$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$yregDir)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.7823     0.8563  -4.417 1.00e-05 ***</span></span>
<span><span class="co">## A             0.3675     0.1735   2.118   0.0342 *  </span></span>
<span><span class="co">## C1            0.2839     0.8440   0.336   0.7366    </span></span>
<span><span class="co">## C2           -1.0638     0.1803  -5.901 3.61e-09 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 1354.8  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1312.7  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 798.25</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Exposure regression for weighting: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = A ~ M + C1 + C2, family = binomial(), data = getCall(x$reg.output$ereg)$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$ereg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -1.4666     0.2542  -5.770 7.91e-09 ***</span></span>
<span><span class="co">## M             1.7067     0.1442  11.832  &lt; 2e-16 ***</span></span>
<span><span class="co">## C1            0.5218     0.2140   2.438   0.0148 *  </span></span>
<span><span class="co">## C2            0.0648     0.0443   1.463   0.1436    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 12534  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 12360  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 12368</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Effect decomposition on the odds ratio scale via the inverse odds ratio weighting approach</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Direct counterfactual imputation estimation with </span></span>
<span><span class="co">##  bootstrap standard errors, percentile confidence intervals and p-values </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##       Estimate Std.error  95% CIL 95% CIU  P.val    </span></span>
<span><span class="co">## Rte    1.24287   0.12206  1.34981   1.514 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnde  1.44092   0.26158  1.43458   1.786 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnie  0.86256   0.06944  0.84762   0.941 &lt;2e-16 ***</span></span>
<span><span class="co">## pm    -0.81541   0.21427 -0.52853  -0.241 &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Rte: total effect odds ratio; Rpnde: pure natural direct effect odds ratio; Rtnie: total natural indirect effect odds ratio; pm: proportion mediated)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Relevant variable values: </span></span>
<span><span class="co">## $a</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $astar</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $yval</span></span>
<span><span class="co">## [1] "1"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-natural-effect-model">The Natural Effect Model<a class="anchor" aria-label="anchor" href="#the-natural-effect-model"></a>
</h3>
</div>
<div class="section level2">
<h2 id="r-messagefwarningfresultshide-res_ne---cmestdata-data-model-ne-outcome-y-exposure-a-mediator-m-basec-cc1-c2-emint-true-yreg-logistic-astar-0-a-1-mval-list1-estimation-imputation-inference-bootstrap-nboot-2">
<code>{r message=F,warning=F,results='hide'} # res_ne &lt;- cmest(data = data, model = "ne", outcome = "Y", exposure = "A", #                 mediator = "M", basec = c("C1", "C2"), EMint = TRUE, #                 yreg = "logistic", #                 astar = 0, a = 1, mval = list(1),  #                 estimation = "imputation", inference = "bootstrap", nboot = 2) #</code><a class="anchor" aria-label="anchor" href="#r-messagefwarningfresultshide-res_ne---cmestdata-data-model-ne-outcome-y-exposure-a-mediator-m-basec-cc1-c2-emint-true-yreg-logistic-astar-0-a-1-mval-list1-estimation-imputation-inference-bootstrap-nboot-2"></a>
</h2>
</div>
<div class="section level2">
<h2 id="section"></h2>
</div>
<div class="section level2">
<h2 id="r-messagefwarningf-summaryres_ne">
<code>{r message=F,warning=F} # summary(res_ne) #</code><a class="anchor" aria-label="anchor" href="#r-messagefwarningf-summaryres_ne"></a>
</h2>
<div class="section level3">
<h3 id="the-marginal-structural-model">The Marginal Structural Model<a class="anchor" aria-label="anchor" href="#the-marginal-structural-model"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_msm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"msm"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                 mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 ereg <span class="op">=</span> <span class="st">"logistic"</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>, mreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>,</span>
<span>                 wmnomreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>, wmdenomreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>,</span>
<span>                 astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                 estimation <span class="op">=</span> <span class="st">"imputation"</span>, inference <span class="op">=</span> <span class="st">"bootstrap"</span>, nboot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_msm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Causal Mediation Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Outcome regression:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Y ~ A + M + A * M, family = binomial(), data = getCall(x$reg.output$yreg)$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$yreg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.1163     0.3762  -8.284   &lt;2e-16 ***</span></span>
<span><span class="co">## A             0.4632     0.6200   0.747   0.4550    </span></span>
<span><span class="co">## M            -0.9908     0.4028  -2.460   0.0139 *  </span></span>
<span><span class="co">## A:M          -0.1803     0.6421  -0.281   0.7789    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 1996.3  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1985.5  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 2014.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Mediator regressions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = M ~ A, family = binomial(), data = getCall(x$reg.output$mreg[[1L]])$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$mreg[[1L]])$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  2.87310    0.07858   36.56   &lt;2e-16 ***</span></span>
<span><span class="co">## A            1.69598    0.14370   11.80   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2271.0  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 2112.9  on 9998  degrees of freedom</span></span>
<span><span class="co">## AIC: 2132.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Mediator regressions for weighting (denominator): </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = M ~ A + C1 + C2, family = binomial(), data = getCall(x$reg.output$wmdenomreg[[1L]])$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$wmdenomreg[[1L]])$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)   0.4353     0.6410   0.679  0.49712    </span></span>
<span><span class="co">## A             1.7076     0.1443  11.837  &lt; 2e-16 ***</span></span>
<span><span class="co">## C1            1.9982     0.6474   3.086  0.00203 ** </span></span>
<span><span class="co">## C2            0.9024     0.1345   6.709 1.96e-11 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2294.0  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 2072.5  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 2080.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Mediator regressions for weighting (nominator): </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = M ~ A, family = binomial(), data = getCall(x$reg.output$wmnomreg[[1L]])$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$wmnomreg[[1L]])$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  2.84922    0.07775   36.65   &lt;2e-16 ***</span></span>
<span><span class="co">## A            1.73145    0.14383   12.04   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2294  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 2128  on 9998  degrees of freedom</span></span>
<span><span class="co">## AIC: 2132</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Exposure regression for weighting: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = A ~ C1 + C2, family = binomial(), data = getCall(x$reg.output$ereg)$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$ereg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span><span class="co">## (Intercept)  0.08342    0.21440   0.389  0.69723   </span></span>
<span><span class="co">## C1           0.60899    0.21208   2.872  0.00409 **</span></span>
<span><span class="co">## C2           0.10532    0.04375   2.407  0.01606 * </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 12534  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 12520  on 9997  degrees of freedom</span></span>
<span><span class="co">## AIC: 12526</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Effect decomposition on the odds ratio scale via the marginal structural model</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Direct counterfactual imputation estimation with </span></span>
<span><span class="co">##  bootstrap standard errors, percentile confidence intervals and p-values </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##                 Estimate Std.error   95% CIL 95% CIU  P.val    </span></span>
<span><span class="co">## Rcde            1.326939  0.024278  1.520315   1.553 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnde           1.357747  0.018355  1.525370   1.550 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnde           1.333507  0.014825  1.526419   1.546 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnie           0.936022  0.018089  0.887888   0.912 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnie           0.919311  0.001338  0.898296   0.900 &lt;2e-16 ***</span></span>
<span><span class="co">## Rte             1.248192  0.014448  1.372974   1.392 &lt;2e-16 ***</span></span>
<span><span class="co">## ERcde           0.294772  0.006927  0.455193   0.464 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintref        0.062975  0.025282  0.060876   0.095 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintmed       -0.045577  0.021996 -0.069846  -0.040 &lt;2e-16 ***</span></span>
<span><span class="co">## ERpnie         -0.063978  0.018089 -0.112103  -0.088 &lt;2e-16 ***</span></span>
<span><span class="co">## ERcde(prop)     1.187675  0.063512  1.160170   1.245 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintref(prop)  0.253737  0.058425  0.163106   0.242 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintmed(prop) -0.183636  0.052083 -0.177908  -0.108 &lt;2e-16 ***</span></span>
<span><span class="co">## ERpnie(prop)   -0.257775  0.057170 -0.300670  -0.224 &lt;2e-16 ***</span></span>
<span><span class="co">## pm             -0.441412  0.005087 -0.408605  -0.402 &lt;2e-16 ***</span></span>
<span><span class="co">## int             0.070100  0.006342  0.055172   0.064 &lt;2e-16 ***</span></span>
<span><span class="co">## pe             -0.187675  0.063512 -0.245499  -0.160 &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Rcde: controlled direct effect odds ratio; Rpnde: pure natural direct effect odds ratio; Rtnde: total natural direct effect odds ratio; Rpnie: pure natural indirect effect odds ratio; Rtnie: total natural indirect effect odds ratio; Rte: total effect odds ratio; ERcde: excess relative risk due to controlled direct effect; ERintref: excess relative risk due to reference interaction; ERintmed: excess relative risk due to mediated interaction; ERpnie: excess relative risk due to pure natural indirect effect; ERcde(prop): proportion ERcde; ERintref(prop): proportion ERintref; ERintmed(prop): proportion ERintmed; ERpnie(prop): proportion ERpnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Relevant variable values: </span></span>
<span><span class="co">## $a</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $astar</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $yval</span></span>
<span><span class="co">## [1] "1"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mval</span></span>
<span><span class="co">## $mval[[1]]</span></span>
<span><span class="co">## [1] 1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-g-formula-approach">The g-formula Approach<a class="anchor" aria-label="anchor" href="#the-g-formula-approach"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_gformula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"gformula"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                      mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      mreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                      astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                      estimation <span class="op">=</span> <span class="st">"imputation"</span>, inference <span class="op">=</span> <span class="st">"bootstrap"</span>, nboot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_gformula</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Causal Mediation Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Outcome regression:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Y ~ A + M + A * M + C1 + C2, family = binomial(), </span></span>
<span><span class="co">##     data = getCall(x$reg.output$yreg)$data, weights = getCall(x$reg.output$yreg)$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.5731     0.7713  -4.633 3.61e-06 ***</span></span>
<span><span class="co">## A             0.7084     0.5283   1.341  0.17990    </span></span>
<span><span class="co">## M            -1.0471     0.3736  -2.803  0.00507 ** </span></span>
<span><span class="co">## C1            0.9337     0.6973   1.339  0.18054    </span></span>
<span><span class="co">## C2           -0.8415     0.1443  -5.829 5.56e-09 ***</span></span>
<span><span class="co">## A:M          -0.4222     0.5541  -0.762  0.44607    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2022.7  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 1965.0  on 9994  degrees of freedom</span></span>
<span><span class="co">## AIC: 1977</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Mediator regressions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = M ~ A + C1 + C2, family = binomial(), data = getCall(x$reg.output$mreg[[1L]])$data, </span></span>
<span><span class="co">##     weights = getCall(x$reg.output$mreg[[1L]])$weights)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)   0.4353     0.6410   0.679  0.49712    </span></span>
<span><span class="co">## A             1.7076     0.1443  11.837  &lt; 2e-16 ***</span></span>
<span><span class="co">## C1            1.9982     0.6474   3.086  0.00203 ** </span></span>
<span><span class="co">## C2            0.9024     0.1345   6.709 1.96e-11 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2294.0  on 9999  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 2072.5  on 9996  degrees of freedom</span></span>
<span><span class="co">## AIC: 2080.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # Effect decomposition on the odds ratio scale via the g-formula approach</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Direct counterfactual imputation estimation with </span></span>
<span><span class="co">##  bootstrap standard errors, percentile confidence intervals and p-values </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##                 Estimate Std.error   95% CIL 95% CIU  P.val    </span></span>
<span><span class="co">## Rcde            1.330044  0.277865  0.988256   1.361      1    </span></span>
<span><span class="co">## Rpnde           1.421621  0.194347  1.124066   1.385 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnde           1.351145  0.255814  1.022707   1.366 &lt;2e-16 ***</span></span>
<span><span class="co">## Rpnie           0.924490  0.044053  0.886909   0.946 &lt;2e-16 ***</span></span>
<span><span class="co">## Rtnie           0.878659  0.010460  0.860782   0.875 &lt;2e-16 ***</span></span>
<span><span class="co">## Rte             1.249120  0.181787  0.967576   1.212      1    </span></span>
<span><span class="co">## ERcde           0.292480  0.236163 -0.009933   0.307      1    </span></span>
<span><span class="co">## ERintref        0.129141  0.041816  0.078530   0.135 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintmed       -0.096991  0.031493 -0.102632  -0.060 &lt;2e-16 ***</span></span>
<span><span class="co">## ERpnie         -0.075510  0.044053 -0.113040  -0.054 &lt;2e-16 ***</span></span>
<span><span class="co">## ERcde(prop)     1.174052  0.680590  0.503465   1.418 &lt;2e-16 ***</span></span>
<span><span class="co">## ERintref(prop)  0.518391  2.773970 -3.472994   0.254      1    </span></span>
<span><span class="co">## ERintmed(prop) -0.389334  2.114797 -0.195649   2.646      1    </span></span>
<span><span class="co">## ERpnie(prop)   -0.303108  1.339763 -0.476034   1.324      1    </span></span>
<span><span class="co">## pm             -0.692443  3.454560 -0.671683   3.970      1    </span></span>
<span><span class="co">## int             0.129057  0.659174 -0.827408   0.058      1    </span></span>
<span><span class="co">## pe             -0.174052  0.680590 -0.417840   0.497      1    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Rcde: controlled direct effect odds ratio; Rpnde: pure natural direct effect odds ratio; Rtnde: total natural direct effect odds ratio; Rpnie: pure natural indirect effect odds ratio; Rtnie: total natural indirect effect odds ratio; Rte: total effect odds ratio; ERcde: excess relative risk due to controlled direct effect; ERintref: excess relative risk due to reference interaction; ERintmed: excess relative risk due to mediated interaction; ERpnie: excess relative risk due to pure natural indirect effect; ERcde(prop): proportion ERcde; ERintref(prop): proportion ERintref; ERintmed(prop): proportion ERintmed; ERpnie(prop): proportion ERpnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Relevant variable values: </span></span>
<span><span class="co">## $a</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $astar</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $yval</span></span>
<span><span class="co">## [1] "1"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mval</span></span>
<span><span class="co">## $mval[[1]]</span></span>
<span><span class="co">## [1] 1</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Baoyi Shi, Ziqing Wang, Christine Choirat, <a href="https://www.lindavaleri.com/" class="external-link">Linda Valeri</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
